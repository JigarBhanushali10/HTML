<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <form id="myForm">

    <label for="email">email</label>
    <input type="text" name="email" id="email">
    <br>
    <label for="password">password</label>
    <input type="password" name="password" id="password">
    <br>
    <button type="button" onclick="myFunction()">Submit</button>
  </form>

  <script>
    // onclick function 
    function myFunction() {
      const elements = document.getElementById("myForm").elements;
      const obj = {};
      // loop to add key value to obj
      for (let i = 0; i < elements.length; i++) {
        let item = elements.item(i);
        if (item.value) {
          obj[item.name] = item.value;
        }
      }
      const dataToSend = JSON.stringify(obj);

      const url = 'https://jsonplaceholder.typicode.com/users'
      const token = 'Bearer Token'//common for both call 
      const body = dataToSend
      // calling funtion apiCall which takes  url, token, body as arguments
      apiCall(url, token, body)
    }

    async function apiCall(url, token, body) {

      await fetch(url, {
        headers: { Authentication: token }
      }).then((res) => {
        // respose of first get call
        res.json().then(res => console.log(res))
        fetch(url, {
          method: 'POST',
          body: body,
          headers: {
            token: token,
          },
        })
          .then((response) => response.json())
          .then((obj) => {
            // respose of second post call
            console.log(obj);
            // extra get call just for dynamic call ( -1 because no object was added to api )
            fetch(`${url}/${obj.id - 1}`).then((response) => response.json()).then((json) => {
              // respose of second get call
              console.log({ json });
            });
          });
      }
      )

    }




    // ------------------raw code----------------------
      // let token = 'Bearer Token'
      // let response = fetch('https://jsonplaceholder.typicode.com/users', {
      //   headers: { Authentication: token }
      // })
      // // .then(resp => resp.json())
      // // .then(json => console.log(json))

      // // setTimeout(() => {
      // response.then(() => {
      //   fetch('https://jsonplaceholder.typicode.com/users', {
      //     method: 'POST',
      //     body: dataToSend,
      //     headers: {
      //       token: 'post call token',
      //     },
      //   })
      //     .then((response) => response.json())
      //     .then((json) => {
      //       fetch(`https://jsonplaceholder.typicode.com/users/${json.id - 1}`).then((response) => response.json())
      //         .then((json) => {
      //           console.log(json);
      //         });
      //     });
      // }
      // )

      // }, 5000);
      // ------------------------raaw code--------------------------
  </script>
</body>

</html>